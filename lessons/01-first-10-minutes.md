<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-T3H552FB');</script>
<!-- End Google Tag Manager -->


# Инженерное мышление в продакшене

## Урок 1: Первые 10 минут, когда всё горит

Пятница, 22:30. Ты только устроился поудобнее дома, и тут телефон начинает жужжать. Прилетел алерт. Латентность эндпоинта /api/orders взлетела с 120 миллисекунд до трёх секунд. Ошибок 5xx стало 12 процентов. Тимлид уже строчит в чате. Говорит, деплой был полчаса назад. Просит глянуть.

В такой момент большинство middle разработчиков делают одну из трёх вещей. Первые хватаются за логи и часами листают их в надежде что то найти. Вторые пытаются починить на лету. Меняют код прямо в продакшене без плана. Третьи просто перезапускают поды или сервисы. Надеются, что проблема сама уйдёт.

Инженер с опытом действует по другому. У него есть структура мышления. Она работает в любой ситуации.

## Стабилизируй, потом разбирайся

Когда падает продакшен, у тебя всегда две задачи. Первая остановить текущий ущерб для пользователей и бизнеса. Вторая понять, что именно произошло. Чтобы это не повторилось. Большая ошибка пытаться сразу решать вторую задачу. Не выполнив первую.

В первые минуты ты задаёшь себе три вопроса. Теряем ли мы деньги или важные данные прямо сейчас. Можно ли безопасно откатить последнее изменение за минуту. Кого нужно предупредить. Чтобы команда была в курсе.

Моя история. Помню случай, когда мы деплойнули новую фичу с кэшированием. Через пятнадцать минут Redis просто лёг. Все соединения висели в состоянии TIME WAIT. Вместо того чтобы лезть в дебаг, просто откатили фичу флаг. Пользователи даже не заметили простоя. Только потом разобрались с лимитами соединений. Настроили пул правильно.

## Чеклист что делать в первые 10 минут

Каждый пункт важен. Пройди их по порядку.

Что именно сломалось. Посмотри метрики и алерты. Это деградация производительности или полный отказ сервиса. Затронуто один эндпоинт или вся система.

Какой масштаб проблемы. Страдают все пользователи или только часть трафика. Пять процентов или восемьдесят. Сколько времени уже длится инцидент.

Возможен ли быстрый откат. Был ли недавний деплой конфигурации или кода. Есть ли флаг который можно выключить. Проверена ли процедура rollback.

Принимаешь решение. Если откат простой и безопасный делаешь его немедленно. Если откат рискованнее текущего состояния начинаешь осторожное расследование.

## Почему мидлы часто усугубляют проблему

Типичная ловушка. Ты видишь проблему, открываешь IDE, пишешь быстрый фикс и деплоишь его в горящую систему. Теперь у тебя не одна проблема, а две. Оригинальная плюс новая от твоих изменений под давлением.

Инженер мыслит иначе. Сначала он уменьшает количество неизвестных. Откатывает к известному состоянию. Наблюдает метрики десять минут. Только потом начинает целенаправленные эксперименты.

Реальный случай из команды. Коллега увидел таймауты в логах и решил увеличить таймаут. Через десять минут вся система зависла намертво. Теперь не только оригинальный сервис, но и соседние тоже страдали от его фикса. Пришлось экстренно откатывать его изменения. А потом уже разбираться с первопричиной.
