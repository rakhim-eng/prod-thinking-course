# Инженерное мышление в продакшене

## Урок 6: Легаси код без тестов план действий

Получаешь задачу изменить модуль написанный пять лет назад. Кода тысячи строк. Тестов ноль. Документации нет. Комментариев тоже. Изменения нужно внести за два дня. Типичная ситуация для большинства команд.

Первая реакция паника или игнор. Либо пытаешься переписать всё. Либо меняешь на минимально необходимое. Оба подхода ведут к новым багам. Нужен системный план.

Первый шаг изучи существующий код. Не пытайся понять каждую строку. Найди границы модуля. Какие входы выходы. Какие внешние зависимости. Построй простую схему как данные проходят через код.

Второй шаг определи область изменений. Что именно нужно поменять. Минимальный путь от входа до выхода. Изолируй эту часть. Добавь хотя бы smoke тесты для границ.

Третий шаг добавь safety net. Перед изменениями запусти интеграционные тесты всей системы. Сохрани baseline метрики. Добавь логи в ключевые места. Теперь любое изменение будет видно.

Четвёртый incremental changes. Разбей задачу на маленькие шаги. Каждый коммит тестируй вручную или простыми скриптами. После каждого изменения проверь что остальной код работает.

Пятый observability. Добавь метрики и алерты для новой логики. Latency запросов. Количество ошибок. Потребление памяти. Теперь система сама расскажет если что то сломалось.

Шестой документация. Напиши хотя бы параграф что ты изменил и почему. Для следующего разработчика. Даже простые заметки лучше полного молчания.

Такой подход превращает легаси монстра в управляемую задачу. Код остаётся стабильным. Ты не создаёшь новых долгов. Команда может доверять изменениям.
